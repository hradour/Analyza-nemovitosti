<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anal√Ωza Nemovitost√≠</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .header-left {
            flex: 1;
            min-width: 300px;
        }

        .header-right {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        h1 {
            color: #1e3c72;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
        }

        .update-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
            padding: 10px 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .update-label {
            font-size: 0.75em;
            color: #666;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .update-time {
            font-size: 0.95em;
            color: #1e3c72;
            font-weight: 600;
        }

        .refresh-button {
            padding: 12px 20px;
            background: #2a5298;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .refresh-button:hover {
            background: #1e3c72;
            transform: translateY(-2px);
        }

        .refresh-button:active {
            transform: translateY(0);
        }

        .refresh-button.loading {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .refresh-icon {
            display: inline-block;
            transition: transform 0.5s ease;
        }

        .refresh-button.loading .refresh-icon {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .location-selector {
            min-width: 250px;
        }

        .location-label {
            font-weight: 600;
            color: #1e3c72;
            margin-bottom: 8px;
            font-size: 0.9em;
            display: block;
        }

        #locationSelect {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #2a5298;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: 600;
            color: #1e3c72;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #locationSelect:hover {
            background: #e9ecef;
            border-color: #1e3c72;
        }

        #locationSelect:focus {
            outline: none;
            border-color: #1e3c72;
            background: white;
        }

        .tabs-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            overflow: hidden;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 18px 35px;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            user-select: none;
        }

        .tab:hover {
            background: #e9ecef;
            color: #1e3c72;
        }

        .tab.active {
            color: #1e3c72;
            background: white;
            border-bottom-color: #2a5298;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 3em;
            margin-bottom: 20px;
        }

        .empty-state-text {
            font-size: 1.2em;
        }

        .settings-section {
            padding: 20px 0;
        }

        .settings-section h3 {
            color: #1e3c72;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .time-inputs {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }

        .time-input-group {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
        }

        .time-input {
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 1em;
            font-weight: 600;
        }

        .time-input:focus {
            outline: none;
            border-color: #2a5298;
        }

        .add-time-button, .remove-time-button {
            padding: 8px 15px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-time-button {
            background: #27ae60;
            color: white;
        }

        .add-time-button:hover {
            background: #229954;
        }

        .remove-time-button {
            background: #e74c3c;
            color: white;
        }

        .remove-time-button:hover {
            background: #c0392b;
        }

        .save-settings-button {
            padding: 12px 30px;
            background: #2a5298;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .save-settings-button:hover {
            background: #1e3c72;
        }

        .scheduled-times {
            margin-top: 20px;
            padding: 15px;
            background: #e8f4f8;
            border-radius: 8px;
            border-left: 4px solid #2a5298;
        }

        .scheduled-times h4 {
            color: #1e3c72;
            margin-bottom: 10px;
        }

        .scheduled-times p {
            color: #666;
            line-height: 1.6;
        }

        .sources-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .source-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .source-item:hover {
            background: #e9ecef;
            border-color: #2a5298;
        }

        .source-item.active {
            background: #e8f4f8;
            border-color: #2a5298;
        }

        .source-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .source-info {
            flex: 1;
        }

        .source-name {
            font-weight: 600;
            color: #1e3c72;
            margin-bottom: 3px;
        }

        .source-url {
            font-size: 0.85em;
            color: #666;
        }

        .source-popularity {
            font-size: 0.75em;
            color: #999;
            margin-top: 3px;
        }

        .source-item.custom {
            border-color: #27ae60;
        }

        .source-item.custom .source-name {
            color: #27ae60;
        }

        .source-delete-btn {
            padding: 5px 10px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 0.85em;
            cursor: pointer;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .source-delete-btn:hover {
            background: #c0392b;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-label {
            color: #666;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #1e3c72;
        }

        .stat-change {
            font-size: 0.9em;
            margin-top: 5px;
        }

        .stat-change.positive {
            color: #27ae60;
        }

        .stat-change.negative {
            color: #e74c3c;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .chart-title {
            font-size: 1.3em;
            color: #1e3c72;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .filters {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .filter-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .filter-item {
            display: flex;
            flex-direction: column;
        }

        label {
            font-weight: 600;
            color: #1e3c72;
            margin-bottom: 8px;
            font-size: 0.9em;
        }

        input, select {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #2a5298;
        }

        .table-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .table-filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            flex: 1;
        }

        .table-filter-input {
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.9em;
            min-width: 150px;
        }

        .table-filter-input:focus {
            outline: none;
            border-color: #2a5298;
        }

        .export-button {
            padding: 10px 20px;
            background: #27ae60;
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .export-button:hover {
            background: #229954;
        }

        .export-button:active {
            transform: scale(0.98);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f8f9fa;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #1e3c72;
            border-bottom: 2px solid #e0e0e0;
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        th:hover {
            background: #e9ecef;
        }

        th::after {
            content: ' ‚áÖ';
            opacity: 0.3;
            font-size: 0.8em;
        }

        th.sort-asc::after {
            content: ' ‚Üë';
            opacity: 1;
        }

        th.sort-desc::after {
            content: ' ‚Üì';
            opacity: 1;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .link-button {
            display: inline-block;
            padding: 8px 16px;
            background: #2a5298;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 600;
            transition: background 0.3s ease;
        }

        .link-button:hover {
            background: #1e3c72;
        }

        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-pronajem {
            background: #e3f2fd;
            color: #1976d2;
        }

        .badge-prodej {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .badge-byt {
            background: #fff3e0;
            color: #f57c00;
        }

        .badge-dum {
            background: #e8f5e9;
            color: #388e3c;
        }

        .badge-pozemek {
            background: #fbe9e7;
            color: #d84315;
        }

        .badge-sreality {
            background: #e8eaf6;
            color: #3f51b5;
        }

        .badge-bezrealitky {
            background: #e0f2f1;
            color: #00796b;
        }

        .badge-idnes {
            background: #fff9c4;
            color: #f57f17;
        }

        canvas {
            max-height: 300px;
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="header-left">
                    <h1>üè† Anal√Ωza Nemovitost√≠</h1>
                    <p class="subtitle">Dashboard pro sledov√°n√≠ a anal√Ωzu inzer√°t≈Ø na prodej a pron√°jem</p>
                </div>
                <div class="header-right">
                    <div class="update-info">
                        <span class="update-label">Posledn√≠ aktualizace</span>
                        <span class="update-time" id="lastUpdateTime">‚Äî</span>
                    </div>
                    <button class="refresh-button" id="refreshButton" onclick="manualRefresh()">
                        <span class="refresh-icon">üîÑ</span>
                        Aktualizovat
                    </button>
                    <div class="location-selector">
                        <label class="location-label" for="locationSelect">üìç Vybran√° lokalita:</label>
                        <select id="locationSelect">
                            <option value="Ben√°tky nad Jizerou">Ben√°tky nad Jizerou</option>
                            <option value="Mlad√° Boleslav">Mlad√° Boleslav</option>
                        </select>
                    </div>
                </div>
            </div>
        </header>

        <div class="tabs-container">
            <div class="tabs">
                <div class="tab active" data-tab="prehled">üìä P≈ôehled</div>
                <div class="tab" data-tab="lustrace">üìú Lustrace</div>
                <div class="tab" data-tab="info">‚öôÔ∏è Info a nastaven√≠</div>
            </div>

            <div class="tab-content active" id="prehled">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">Celkem inzer√°t≈Ø</div>
                        <div class="stat-value" id="totalCount">0</div>
                        <div class="stat-change positive">+12 tento t√Ωden</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Nov√© dnes</div>
                        <div class="stat-value" id="newToday">0</div>
                        <div class="stat-change positive">Aktivn√≠ sledov√°n√≠</div>
                    </div>
                </div>

                <div class="filters">
                    <h2 class="chart-title">üîç Filtry</h2>
                    <div class="filter-group">
                        <div class="filter-item">
                            <label for="filterType">Typ transakce</label>
                            <select id="filterType">
                                <option value="">V≈°e</option>
                                <option value="Pron√°jem">Pron√°jem</option>
                                <option value="Prodej">Prodej</option>
                            </select>
                        </div>
                        <div class="filter-item">
                            <label for="filterProperty">Typ nemovitosti</label>
                            <select id="filterProperty">
                                <option value="">V≈°e</option>
                                <option value="Byt">Byt</option>
                                <option value="D≈Øm">D≈Øm</option>
                                <option value="Pozemek">Pozemek</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-card">
                        <h3 class="chart-title">üìà V√Ωvoj poƒçtu inzer√°t≈Ø</h3>
                        <canvas id="timelineChart"></canvas>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <h3 class="chart-title">üìã Seznam inzer√°t≈Ø</h3>
                        <button class="export-button" onclick="exportToExcel()">
                            üìä Export do XLS
                        </button>
                    </div>
                    <table id="listingsTable">
                        <thead>
                            <tr>
                                <th onclick="sortTable(0)" data-column="0">Typ transakce</th>
                                <th onclick="sortTable(1)" data-column="1">Typ nemovitosti</th>
                                <th onclick="sortTable(2)" data-column="2">Zdroj</th>
                                <th onclick="sortTable(3)" data-column="3">Cena</th>
                                <th onclick="sortTable(4)" data-column="4">Plocha</th>
                                <th onclick="sortTable(5)" data-column="5">Cena/m¬≤</th>
                                <th onclick="sortTable(6)" data-column="6">Datum zve≈ôejnƒõn√≠</th>
                                <th>Odkaz</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tab-content" id="lustrace">
                <div class="settings-section">
                    <h3>üîç Lustrace osoby</h3>
                    <p style="color: #666; margin-bottom: 25px;">
                        Zadejte √∫daje osoby pro vyhled√°n√≠ v datab√°z√≠ch ISIR (insolvenƒçn√≠ rejst≈ô√≠k) a CEE (centr√°ln√≠ evidence exekuc√≠).
                    </p>
                    
                    <div style="background: #f8f9fa; padding: 25px; border-radius: 10px; border: 2px solid #e0e0e0; margin-bottom: 30px;">
                        <h4 style="color: #1e3c72; margin-bottom: 20px;">üìù Vstupn√≠ √∫daje</h4>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #1e3c72; font-size: 0.9em;">Jm√©no:</label>
                                <input type="text" id="lustraceJmeno" placeholder="Zadejte jm√©no" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 1em;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #1e3c72; font-size: 0.9em;">P≈ô√≠jmen√≠:</label>
                                <input type="text" id="lustracePrijmeni" placeholder="Zadejte p≈ô√≠jmen√≠" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 1em;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #1e3c72; font-size: 0.9em;">Datum narozen√≠:</label>
                                <input type="date" id="lustraceDatumNarozeni" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 1em;">
                            </div>
                        </div>
                        
                        <div style="margin-top: 25px;">
                            <button onclick="spustitLustraci()" style="padding: 14px 35px; background: #2a5298; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1.1em; transition: all 0.3s ease;">
                                üîç Spustit lustraci
                            </button>
                            <button onclick="vymazatFormular()" style="padding: 14px 25px; background: #95a5a6; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 1em; margin-left: 10px; transition: all 0.3s ease;">
                                üóëÔ∏è Vymazat
                            </button>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 25px;">
                        <!-- ISIR API -->
                        <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e74c3c; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                                <span style="font-size: 2em;">‚ö†Ô∏è</span>
                                <h4 style="color: #e74c3c; margin: 0;">ISIR - Insolvenƒçn√≠ rejst≈ô√≠k</h4>
                            </div>
                            
                            <div id="isirStatus" style="padding: 12px; background: #ecf0f1; border-radius: 6px; margin-bottom: 15px; font-weight: 600; color: #7f8c8d;">
                                ƒåek√° na spu≈°tƒõn√≠ lustrace...
                            </div>
                            
                            <div id="isirResults" style="min-height: 150px; padding: 15px; background: #fafafa; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <p style="color: #999; text-align: center; margin: 50px 0;">V√Ωsledky se zobraz√≠ po spu≈°tƒõn√≠ lustrace</p>
                            </div>
                            
                            <div style="margin-top: 15px; padding: 10px; background: #fff5f5; border-left: 4px solid #e74c3c; border-radius: 4px;">
                                <p style="margin: 0; font-size: 0.9em; color: #666; line-height: 1.6;">
                                    <strong>ISIR</strong> obsahuje informace o insolvenc√≠ch, konkurzech a reorganizac√≠ch.
                                </p>
                            </div>
                        </div>
                        
                        <!-- CEE API -->
                        <div style="background: white; padding: 25px; border-radius: 10px; border: 2px solid #e67e22; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 20px;">
                                <span style="font-size: 2em;">üìã</span>
                                <h4 style="color: #e67e22; margin: 0;">CEE - Centr√°ln√≠ evidence exekuc√≠</h4>
                            </div>
                            
                            <div id="ceeStatus" style="padding: 12px; background: #ecf0f1; border-radius: 6px; margin-bottom: 15px; font-weight: 600; color: #7f8c8d;">
                                ƒåek√° na spu≈°tƒõn√≠ lustrace...
                            </div>
                            
                            <div id="ceeResults" style="min-height: 150px; padding: 15px; background: #fafafa; border-radius: 6px; border: 1px solid #e0e0e0;">
                                <p style="color: #999; text-align: center; margin: 50px 0;">V√Ωsledky se zobraz√≠ po spu≈°tƒõn√≠ lustrace</p>
                            </div>
                            
                            <div style="margin-top: 15px; padding: 10px; background: #fff9f5; border-left: 4px solid #e67e22; border-radius: 4px;">
                                <p style="margin: 0; font-size: 0.9em; color: #666; line-height: 1.6;">
                                    <strong>CEE</strong> obsahuje informace o prob√≠haj√≠c√≠ch a ukonƒçen√Ωch exekuc√≠ch.
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: #e8f4f8; border-radius: 8px; border-left: 4px solid #2a5298;">
                        <h4 style="color: #1e3c72; margin-bottom: 10px;">‚ÑπÔ∏è Informace o lustraci</h4>
                        <p style="color: #666; line-height: 1.8; margin: 0;">
                            Lustrace prob√≠h√° dotazem na ve≈ôejn√© datab√°ze:
                        </p>
                        <ul style="color: #666; line-height: 1.8; margin: 10px 0 0 20px;">
                            <li><strong>ISIR.cz</strong> - ofici√°ln√≠ insolvenƒçn√≠ rejst≈ô√≠k ƒåR</li>
                            <li><strong>Exekutorsk√° komora ƒåR</strong> - centr√°ln√≠ evidence exekuc√≠</li>
                        </ul>
                        <p style="color: #666; line-height: 1.8; margin: 10px 0 0 0;">
                            V√Ωsledky slou≈æ√≠ pouze pro informaƒçn√≠ √∫ƒçely. Pro pr√°vn√≠ √∫ƒçely si v≈ædy ovƒõ≈ôte informace p≈ô√≠mo v ofici√°ln√≠ch zdroj√≠ch.
                        </p>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="info">
                <div class="settings-section">
                    <h3>üåê Zdroje dat - webov√© port√°ly</h3>
                    <p style="color: #666; margin-bottom: 20px;">
                        Vyberte, kter√© webov√© port√°ly s inzer√°ty nemovitost√≠ chcete prohled√°vat. Za≈°krtnut√© port√°ly budou aktivn√≠ pro sbƒõr dat.
                    </p>
                    
                    <div id="sourcesContainer" class="sources-list">
                        <!-- Zdroje budou p≈ôid√°ny JavaScriptem -->
                    </div>
                    
                    <div style="margin-top: 25px; padding: 20px; background: #f8f9fa; border-radius: 8px; border: 2px dashed #2a5298;">
                        <h4 style="color: #1e3c72; margin-bottom: 15px;">‚ûï P≈ôidat vlastn√≠ zdroj</h4>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: end;">
                            <div style="flex: 1; min-width: 200px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #1e3c72; font-size: 0.9em;">N√°zev port√°lu:</label>
                                <input type="text" id="customSourceName" placeholder="nap≈ô. M≈ØjPort√°l.cz" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 1em;">
                            </div>
                            <div style="flex: 1; min-width: 250px;">
                                <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #1e3c72; font-size: 0.9em;">URL adresa:</label>
                                <input type="url" id="customSourceUrl" placeholder="nap≈ô. www.mujportal.cz" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 1em;">
                            </div>
                            <button onclick="addCustomSource()" style="padding: 10px 20px; background: #27ae60; color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; white-space: nowrap;">
                                ‚ûï P≈ôidat zdroj
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="save-settings-button" onclick="saveSources()">üíæ Ulo≈æit v√Ωbƒõr zdroj≈Ø</button>
                    </div>
                    
                    <div class="scheduled-times" id="sourcesInfo" style="margin-top: 20px;">
                        <h4>‚úÖ Aktu√°lnƒõ aktivn√≠ zdroje:</h4>
                        <p id="activeSourcesDisplay">‚Äî</p>
                    </div>
                </div>

                <div class="settings-section" style="margin-top: 40px; padding-top: 40px; border-top: 2px solid #e0e0e0;">
                    <h3>‚è∞ Automatick√° aktualizace dat</h3>
                    <p style="color: #666; margin-bottom: 20px;">
                        Nastavte ƒçasy, kdy se maj√≠ data automaticky aktualizovat. M≈Ø≈æete p≈ôidat v√≠ce ƒças≈Ø bƒõhem dne.
                    </p>
                    
                    <div id="timeInputsContainer" class="time-inputs">
                        <div class="time-input-group">
                            <span>‚è∞</span>
                            <input type="time" class="time-input" value="08:00">
                            <button class="remove-time-button" onclick="removeTimeInput(this)">‚úï</button>
                        </div>
                    </div>
                    
                    <button class="add-time-button" onclick="addTimeInput()">+ P≈ôidat dal≈°√≠ ƒças</button>
                    
                    <div style="margin-top: 30px;">
                        <button class="save-settings-button" onclick="saveSchedule()">üíæ Ulo≈æit nastaven√≠</button>
                    </div>
                    
                    <div class="scheduled-times" id="scheduledTimesInfo">
                        <h4>üìã Aktu√°ln√≠ pl√°n aktualizac√≠:</h4>
                        <p id="scheduleDisplay">Zat√≠m nejsou nastaveny ≈æ√°dn√© ƒçasy automatick√© aktualizace.</p>
                    </div>
                </div>

                <div class="settings-section" style="margin-top: 40px; padding-top: 40px; border-top: 2px solid #e0e0e0;">
                    <h3>‚ÑπÔ∏è Informace o aplikaci</h3>
                    <p style="color: #666; line-height: 1.8;">
                        <strong>Verze:</strong> 1.0.0<br>
                        <strong>Sledovan√© lokality:</strong> Ben√°tky nad Jizerou, Mlad√° Boleslav<br>
                        <strong>Zdroje dat:</strong> <span id="infoSources">‚Äî</span><br>
                        <strong>Posledn√≠ aktualizace aplikace:</strong> ≈ò√≠jen 2024
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // KONFIGURACE LOKALIT - zde m≈Ø≈æete jednodu≈°e p≈ôid√°vat/odeb√≠rat lokality
        const WATCHED_LOCATIONS = [
            "Ben√°tky nad Jizerou",
            "Mlad√° Boleslav"
        ];

        // Testovac√≠ data
        const listings = [
            { type: "Pron√°jem", property: "Byt", city: "Ben√°tky nad Jizerou", source: "Sreality.cz", price: 12000, area: 55, date: "2024-10-20", url: "https://www.sreality.cz/detail/pronajem/byt/2+kk/benatky-nad-jizerou/12345" },
            { type: "Prodej", property: "Byt", city: "Ben√°tky nad Jizerou", source: "Bezrealitky.cz", price: 3500000, area: 65, date: "2024-10-19", url: "https://www.bezrealitky.cz/nemovitosti-byty-domy/12346" },
            { type: "Pron√°jem", property: "D≈Øm", city: "Mlad√° Boleslav", source: "Sreality.cz", price: 18000, area: 120, date: "2024-10-21", url: "https://www.sreality.cz/detail/pronajem/dum/rodinny/mlada-boleslav/12347" },
            { type: "Prodej", property: "D≈Øm", city: "Mlad√° Boleslav", source: "Reality.idnes.cz", price: 7500000, area: 150, date: "2024-10-18", url: "https://reality.idnes.cz/detail/prodej/dum/12348" },
            { type: "Pron√°jem", property: "Byt", city: "Ben√°tky nad Jizerou", source: "Bezrealitky.cz", price: 10000, area: 50, date: "2024-10-22", url: "https://www.bezrealitky.cz/nemovitosti-byty-domy/12349" },
            { type: "Prodej", property: "Byt", city: "Mlad√° Boleslav", source: "Sreality.cz", price: 4200000, area: 68, date: "2024-10-17", url: "https://www.sreality.cz/detail/prodej/byt/2+1/mlada-boleslav/12350" },
            { type: "Pron√°jem", property: "Byt", city: "Ben√°tky nad Jizerou", source: "Reality.idnes.cz", price: 11000, area: 52, date: "2024-10-23", url: "https://reality.idnes.cz/detail/pronajem/byt/12351" },
            { type: "Prodej", property: "Pozemek", city: "Mlad√° Boleslav", source: "Sreality.cz", price: 2500000, area: 800, date: "2024-10-16", url: "https://www.sreality.cz/detail/prodej/pozemek/bydleni/mlada-boleslav/12352" },
            { type: "Pron√°jem", property: "D≈Øm", city: "Ben√°tky nad Jizerou", source: "Bezrealitky.cz", price: 20000, area: 140, date: "2024-10-21", url: "https://www.bezrealitky.cz/nemovitosti-byty-domy/12353" },
            { type: "Prodej", property: "D≈Øm", city: "Mlad√° Boleslav", source: "Reality.idnes.cz", price: 8800000, area: 160, date: "2024-10-20", url: "https://reality.idnes.cz/detail/prodej/dum/12354" },
            { type: "Pron√°jem", property: "Byt", city: "Ben√°tky nad Jizerou", source: "Sreality.cz", price: 13000, area: 60, date: "2024-10-22", url: "https://www.sreality.cz/detail/pronajem/byt/3+kk/benatky-nad-jizerou/12355" },
            { type: "Prodej", property: "Byt", city: "Mlad√° Boleslav", source: "Bezrealitky.cz", price: 3800000, area: 62, date: "2024-10-19", url: "https://www.bezrealitky.cz/nemovitosti-byty-domy/12356" },
            { type: "Pron√°jem", property: "Byt", city: "Ben√°tky nad Jizerou", source: "Reality.idnes.cz", price: 9500, area: 48, date: "2024-10-23", url: "https://reality.idnes.cz/detail/pronajem/byt/12357" },
            { type: "Prodej", property: "D≈Øm", city: "Mlad√° Boleslav", source: "Sreality.cz", price: 6200000, area: 125, date: "2024-10-18", url: "https://www.sreality.cz/detail/prodej/dum/rodinny/mlada-boleslav/12358" },
            { type: "Pron√°jem", property: "Byt", city: "Ben√°tky nad Jizerou", source: "Bezrealitky.cz", price: 11500, area: 54, date: "2024-10-21", url: "https://www.bezrealitky.cz/nemovitosti-byty-domy/12359" },
            { type: "Prodej", property: "Pozemek", city: "Mlad√° Boleslav", source: "Reality.idnes.cz", price: 1800000, area: 650, date: "2024-10-17", url: "https://reality.idnes.cz/detail/prodej/pozemek/12360" },
            { type: "Pron√°jem", property: "D≈Øm", city: "Ben√°tky nad Jizerou", source: "Sreality.cz", price: 22000, area: 130, date: "2024-10-22", url: "https://www.sreality.cz/detail/pronajem/dum/rodinny/benatky-nad-jizerou/12361" },
            { type: "Prodej", property: "Byt", city: "Mlad√° Boleslav", source: "Bezrealitky.cz", price: 3200000, area: 58, date: "2024-10-20", url: "https://www.bezrealitky.cz/nemovitosti-byty-domy/12362" },
            { type: "Pron√°jem", property: "Byt", city: "Ben√°tky nad Jizerou", source: "Reality.idnes.cz", price: 10500, area: 51, date: "2024-10-23", url: "https://reality.idnes.cz/detail/pronajem/byt/12363" },
            { type: "Prodej", property: "D≈Øm", city: "Mlad√° Boleslav", source: "Sreality.cz", price: 8900000, area: 170, date: "2024-10-19", url: "https://www.sreality.cz/detail/prodej/dum/rodinny/mlada-boleslav/12364" }
        ];

        let filteredListings = [...listings];
        let currentLocation = WATCHED_LOCATIONS[0];
        let lastUpdateTime = null;
        let scheduledTimes = [];
        let autoRefreshIntervals = [];
        
        // Top 10 ƒçesk√Ωch port√°l≈Ø pro nemovitosti
        const realtyWebsites = [
            { id: 'sreality', name: 'Sreality.cz', url: 'www.sreality.cz', active: true, popularity: '#1 - Nejv√≠ce n√°v≈°tƒõv', custom: false },
            { id: 'bezrealitky', name: 'Bezrealitky.cz', url: 'www.bezrealitky.cz', active: true, popularity: '#2 - Bez proviz√≠', custom: false },
            { id: 'reality-idnes', name: 'Reality iDNES.cz', url: 'reality.idnes.cz', active: true, popularity: '#3 - Zpravodajsk√Ω port√°l', custom: false },
            { id: 'mmreality', name: 'MMReality.cz', url: 'www.mmreality.cz', active: false, popularity: '#4 - Makl√©≈ôsk√° s√≠≈•', custom: false },
            { id: 'realitymix', name: 'RealityMix.cz', url: 'www.realitymix.cz', active: false, popularity: '#5 - Agreg√°tor', custom: false },
            { id: 'remax', name: 'RE/MAX.cz', url: 'www.remax.cz', active: false, popularity: '#6 - Mezin√°rodn√≠ s√≠≈•', custom: false },
            { id: 'ulovdomov', name: 'UlovDomov.cz', url: 'www.ulovdomov.cz', active: false, popularity: '#7 - Inzertn√≠ port√°l', custom: false },
            { id: 'reality-centrum', name: 'Reality Centrum.cz', url: 'reality.centrum.cz', active: false, popularity: '#8 - Seznam.cz', custom: false },
            { id: 'realcity', name: 'RealCity.cz', url: 'www.realcity.cz', active: false, popularity: '#9 - Region√°ln√≠ inzerce', custom: false },
            { id: 'hyperinzerce', name: 'Hyperinzerce.cz', url: 'www.hyperinzerce.cz', active: false, popularity: '#10 - ≈†irok√° nab√≠dka', custom: false }
        ];

        // Statistiky
        function updateStats() {
            const total = filteredListings.length;
            const newToday = filteredListings.filter(l => l.date === "2024-10-23").length;

            document.getElementById('totalCount').textContent = total;
            document.getElementById('newToday').textContent = newToday;
        }

        // Tabulka
        function renderTable() {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';
            
            filteredListings.forEach(listing => {
                const pricePerM2 = Math.round(listing.price / listing.area);
                const sourceBadgeClass = listing.source.toLowerCase().replace(/\./g, '').replace('cz', '');
                const row = `
                    <tr>
                        <td><span class="badge badge-${listing.type.toLowerCase()}">${listing.type}</span></td>
                        <td><span class="badge badge-${listing.property.toLowerCase()}">${listing.property}</span></td>
                        <td><span class="badge badge-${sourceBadgeClass}">${listing.source}</span></td>
                        <td><strong>${listing.price.toLocaleString('cs-CZ')} Kƒç</strong></td>
                        <td>${listing.area} m¬≤</td>
                        <td>${pricePerM2.toLocaleString('cs-CZ')} Kƒç/m¬≤</td>
                        <td>${new Date(listing.date).toLocaleDateString('cs-CZ')}</td>
                        <td><a href="${listing.url}" target="_blank" class="link-button">Zobrazit inzer√°t</a></td>
                    </tr>
                `;
                tbody.innerHTML += row;
            });
        }

        // Grafy
        let timelineChart;

        function createCharts() {
            // Timeline
            const dateGroups = {};
            filteredListings.forEach(l => {
                if (!dateGroups[l.date]) dateGroups[l.date] = 0;
                dateGroups[l.date]++;
            });
            const sortedDates = Object.keys(dateGroups).sort();

            const ctxTimeline = document.getElementById('timelineChart').getContext('2d');
            if (timelineChart) timelineChart.destroy();
            timelineChart = new Chart(ctxTimeline, {
                type: 'line',
                data: {
                    labels: sortedDates.map(d => new Date(d).toLocaleDateString('cs-CZ')),
                    datasets: [{
                        label: 'Poƒçet inzer√°t≈Ø',
                        data: sortedDates.map(d => dateGroups[d]),
                        borderColor: '#2a5298',
                        backgroundColor: 'rgba(42, 82, 152, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: false } }
                }
            });
        }

        // Filtry
        function applyFilters() {
            const typeFilter = document.getElementById('filterType').value;
            const propertyFilter = document.getElementById('filterProperty').value;

            filteredListings = listings.filter(listing => {
                // Filtr podle vybran√© lokality (glob√°ln√≠)
                if (listing.city !== currentLocation) return false;
                
                if (typeFilter && listing.type !== typeFilter) return false;
                if (propertyFilter && listing.property !== propertyFilter) return false;
                
                return true;
            });

            updateStats();
            renderTable();
            createCharts();
        }

        // Zmƒõna lokality
        function changeLocation() {
            currentLocation = document.getElementById('locationSelect').value;
            applyFilters();
        }

        // Export do Excelu
        function exportToExcel() {
            // Vytvo≈ôen√≠ CSV obsahu
            let csv = 'Typ transakce,Typ nemovitosti,Zdroj,Lokalita,Cena (Kƒç),Plocha (m¬≤),Cena za m¬≤ (Kƒç),Datum zve≈ôejnƒõn√≠,URL\n';
            
            filteredListings.forEach(listing => {
                const pricePerM2 = Math.round(listing.price / listing.area);
                const row = [
                    listing.type,
                    listing.property,
                    listing.source,
                    listing.city,
                    listing.price,
                    listing.area,
                    pricePerM2,
                    new Date(listing.date).toLocaleDateString('cs-CZ'),
                    listing.url
                ].map(field => `"${field}"`).join(',');
                csv += row + '\n';
            });

            // P≈ôid√°n√≠ BOM pro spr√°vn√© zobrazen√≠ diakritiky v Excelu
            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csv], { type: 'text/csv;charset=utf-8;' });
            
            // Vytvo≈ôen√≠ odkazu pro sta≈æen√≠
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            const filename = `inzeraty_${currentLocation.replace(/\s+/g, '_')}_${new Date().toISOString().split('T')[0]}.csv`;
            
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Aktualizace ƒçasu posledn√≠ aktualizace
        function updateLastUpdateTime() {
            lastUpdateTime = new Date();
            const timeString = lastUpdateTime.toLocaleString('cs-CZ', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('lastUpdateTime').textContent = timeString;
        }

        // Manu√°ln√≠ refresh
        function manualRefresh() {
            const button = document.getElementById('refreshButton');
            button.classList.add('loading');
            button.disabled = true;

            // Simulace naƒç√≠t√°n√≠ dat (v re√°ln√© aplikaci by zde byl fetch na API)
            setTimeout(() => {
                updateLastUpdateTime();
                applyFilters();
                button.classList.remove('loading');
                button.disabled = false;
            }, 1000);
        }

        // P≈ôid√°n√≠ ƒçasu pro automatickou aktualizaci
        function addTimeInput() {
            const container = document.getElementById('timeInputsContainer');
            const newInput = document.createElement('div');
            newInput.className = 'time-input-group';
            newInput.innerHTML = `
                <span>‚è∞</span>
                <input type="time" class="time-input" value="12:00">
                <button class="remove-time-button" onclick="removeTimeInput(this)">‚úï</button>
            `;
            container.appendChild(newInput);
        }

        // Odstranƒõn√≠ ƒçasu
        function removeTimeInput(button) {
            const container = document.getElementById('timeInputsContainer');
            if (container.children.length > 1) {
                button.parentElement.remove();
            } else {
                alert('Mus√≠ z≈Østat alespo≈à jeden ƒças!');
            }
        }

        // Ulo≈æen√≠ pl√°nu aktualizac√≠
        function saveSchedule() {
            const timeInputs = document.querySelectorAll('.time-input');
            scheduledTimes = Array.from(timeInputs).map(input => input.value).sort();
            
            // Vyƒçi≈°tƒõn√≠ star√Ωch interval≈Ø
            autoRefreshIntervals.forEach(interval => clearInterval(interval));
            autoRefreshIntervals = [];
            
            // Nastaven√≠ nov√Ωch interval≈Ø
            scheduledTimes.forEach(time => {
                checkAndScheduleUpdate(time);
            });
            
            // Zobrazen√≠ ulo≈æen√©ho pl√°nu
            const displayElement = document.getElementById('scheduleDisplay');
            if (scheduledTimes.length > 0) {
                displayElement.innerHTML = `Automatick√° aktualizace nastavena na: <strong>${scheduledTimes.join(', ')}</strong>`;
            } else {
                displayElement.textContent = 'Zat√≠m nejsou nastaveny ≈æ√°dn√© ƒçasy automatick√© aktualizace.';
            }
            
            alert('‚úÖ Pl√°n aktualizac√≠ byl √∫spƒõ≈°nƒõ ulo≈æen!');
        }

        // Kontrola a napl√°nov√°n√≠ aktualizace
        function checkAndScheduleUpdate(scheduledTime) {
            const [hours, minutes] = scheduledTime.split(':').map(Number);
            
            // Kontrola ka≈ædou minutu, zda nastal ƒças aktualizace
            const interval = setInterval(() => {
                const now = new Date();
                if (now.getHours() === hours && now.getMinutes() === minutes && now.getSeconds() === 0) {
                    console.log(`Automatick√° aktualizace v ${scheduledTime}`);
                    manualRefresh();
                }
            }, 1000);
            
            autoRefreshIntervals.push(interval);
        }

        // Vykreslen√≠ seznamu zdroj≈Ø
        function renderSources() {
            const container = document.getElementById('sourcesContainer');
            container.innerHTML = '';
            
            realtyWebsites.forEach(source => {
                const item = document.createElement('div');
                item.className = `source-item ${source.active ? 'active' : ''} ${source.custom ? 'custom' : ''}`;
                item.innerHTML = `
                    <input type="checkbox" 
                           class="source-checkbox" 
                           id="source-${source.id}" 
                           ${source.active ? 'checked' : ''}
                           onchange="toggleSource('${source.id}')">
                    <div class="source-info">
                        <div class="source-name">${source.custom ? 'üåü ' : ''}${source.name}</div>
                        <div class="source-url">${source.url}</div>
                        <div class="source-popularity">${source.popularity}</div>
                    </div>
                    ${source.custom ? `<button class="source-delete-btn" onclick="deleteCustomSource('${source.id}'); event.stopPropagation();">üóëÔ∏è Smazat</button>` : ''}
                `;
                
                // Kliknut√≠ na celou polo≈æku toggleuje checkbox
                item.addEventListener('click', (e) => {
                    if (e.target.type !== 'checkbox' && !e.target.classList.contains('source-delete-btn')) {
                        const checkbox = item.querySelector('.source-checkbox');
                        checkbox.checked = !checkbox.checked;
                        toggleSource(source.id);
                    }
                });
                
                container.appendChild(item);
            });
            
            updateActiveSourcesDisplay();
        }

        // Toggle zdroje
        function toggleSource(sourceId) {
            const source = realtyWebsites.find(s => s.id === sourceId);
            if (source) {
                source.active = !source.active;
                const item = document.getElementById(`source-${sourceId}`).closest('.source-item');
                item.classList.toggle('active', source.active);
                updateActiveSourcesDisplay();
            }
        }

        // P≈ôid√°n√≠ vlastn√≠ho zdroje
        function addCustomSource() {
            const nameInput = document.getElementById('customSourceName');
            const urlInput = document.getElementById('customSourceUrl');
            
            const name = nameInput.value.trim();
            const url = urlInput.value.trim();
            
            if (!name || !url) {
                alert('‚ö†Ô∏è Vypl≈àte pros√≠m n√°zev i URL adresu port√°lu!');
                return;
            }
            
            // Vytvo≈ôen√≠ ID z n√°zvu
            const id = 'custom-' + name.toLowerCase().replace(/[^a-z0-9]/g, '-') + '-' + Date.now();
            
            // P≈ôid√°n√≠ do seznamu
            realtyWebsites.push({
                id: id,
                name: name,
                url: url,
                active: true,
                popularity: '‚≠ê Vlastn√≠ zdroj',
                custom: true
            });
            
            // Vyƒçi≈°tƒõn√≠ formul√°≈ôe
            nameInput.value = '';
            urlInput.value = '';
            
            // P≈ôekreslen√≠
            renderSources();
            
            alert(`‚úÖ Vlastn√≠ zdroj "${name}" byl √∫spƒõ≈°nƒõ p≈ôid√°n!`);
        }

        // Smaz√°n√≠ vlastn√≠ho zdroje
        function deleteCustomSource(sourceId) {
            const sourceIndex = realtyWebsites.findIndex(s => s.id === sourceId);
            if (sourceIndex !== -1) {
                const source = realtyWebsites[sourceIndex];
                if (confirm(`Opravdu chcete smazat vlastn√≠ zdroj "${source.name}"?`)) {
                    realtyWebsites.splice(sourceIndex, 1);
                    renderSources();
                }
            }
        }

        // Ulo≈æen√≠ v√Ωbƒõru zdroj≈Ø
        function saveSources() {
            const activeSources = realtyWebsites.filter(s => s.active);
            
            if (activeSources.length === 0) {
                alert('‚ö†Ô∏è Mus√≠te vybrat alespo≈à jeden zdroj dat!');
                return;
            }
            
            updateActiveSourcesDisplay();
            
            // Aktualizace info sekce
            const infoSources = activeSources.map(s => s.name).join(', ');
            document.getElementById('infoSources').textContent = infoSources;
            
            alert(`‚úÖ V√Ωbƒõr zdroj≈Ø byl √∫spƒõ≈°nƒõ ulo≈æen!\n\nAktivn√≠ zdroje (${activeSources.length}): ${activeSources.map(s => s.name).join(', ')}`);
        }

        // Aktualizace zobrazen√≠ aktivn√≠ch zdroj≈Ø
        function updateActiveSourcesDisplay() {
            const activeSources = realtyWebsites.filter(s => s.active);
            const displayElement = document.getElementById('activeSourcesDisplay');
            const infoElement = document.getElementById('infoSources');
            
            if (activeSources.length > 0) {
                const sourcesList = activeSources.map(s => `<strong>${s.name}</strong>`).join(', ');
                displayElement.innerHTML = `${activeSources.length} ${activeSources.length === 1 ? 'zdroj' : activeSources.length < 5 ? 'zdroje' : 'zdroj≈Ø'}: ${sourcesList}`;
                infoElement.innerHTML = activeSources.map(s => s.name).join(', ');
            } else {
                displayElement.textContent = '≈Ω√°dn√© zdroje nejsou vybr√°ny.';
                infoElement.textContent = '‚Äî';
            }
        }

        // Lustrace - Spu≈°tƒõn√≠
        function spustitLustraci() {
            const jmeno = document.getElementById('lustraceJmeno').value.trim();
            const prijmeni = document.getElementById('lustracePrijmeni').value.trim();
            const datumNarozeni = document.getElementById('lustraceDatumNarozeni').value;
            
            if (!jmeno || !prijmeni || !datumNarozeni) {
                alert('‚ö†Ô∏è Vypl≈àte pros√≠m v≈°echny √∫daje (jm√©no, p≈ô√≠jmen√≠ a datum narozen√≠)!');
                return;
            }
            
            // Form√°tov√°n√≠ data
            const datum = new Date(datumNarozeni);
            const datumFormatovany = datum.toLocaleDateString('cs-CZ');
            
            // Nastaven√≠ loading stavu
            document.getElementById('isirStatus').innerHTML = 'üîÑ Prob√≠h√° dotaz na ISIR API...';
            document.getElementById('isirStatus').style.background = '#fff3cd';
            document.getElementById('isirStatus').style.color = '#856404';
            
            document.getElementById('ceeStatus').innerHTML = 'üîÑ Prob√≠h√° dotaz na CEE API...';
            document.getElementById('ceeStatus').style.background = '#fff3cd';
            document.getElementById('ceeStatus').style.color = '#856404';
            
            // Simulace API vol√°n√≠ (v re√°ln√© aplikaci by zde byl skuteƒçn√Ω fetch)
            setTimeout(() => {
                zobrazitIsirVysledky(jmeno, prijmeni, datumFormatovany);
            }, 1500);
            
            setTimeout(() => {
                zobrazitCeeVysledky(jmeno, prijmeni, datumFormatovany);
            }, 2000);
        }

        // Zobrazen√≠ ISIR v√Ωsledk≈Ø
        function zobrazitIsirVysledky(jmeno, prijmeni, datum) {
            // Simulace v√Ωsledk≈Ø (v re√°ln√© aplikaci by p≈ôi≈°ly z API)
            const nalezeno = Math.random() > 0.7; // 30% ≈°ance na n√°lez
            
            const statusEl = document.getElementById('isirStatus');
            const resultsEl = document.getElementById('isirResults');
            
            if (nalezeno) {
                statusEl.innerHTML = '‚ùå Nalezeny z√°znamy v ISIR';
                statusEl.style.background = '#f8d7da';
                statusEl.style.color = '#721c24';
                
                resultsEl.innerHTML = `
                    <div style="color: #721c24;">
                        <p style="margin-bottom: 15px;"><strong>Osoba:</strong> ${jmeno} ${prijmeni}, nar. ${datum}</p>
                        <div style="padding: 12px; background: #fff; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #e74c3c;">
                            <strong>Insolvence ƒç. 1:</strong><br>
                            Spisov√° znaƒçka: KSOS 123 INS 45678/2023<br>
                            Stav: Prob√≠haj√≠c√≠<br>
                            Datum zah√°jen√≠: ${new Date(Date.now() - Math.random() * 365 * 24 * 60 * 60 * 1000).toLocaleDateString('cs-CZ')}<br>
                            Zp≈Øsob ≈ôe≈°en√≠: Oddlu≈æen√≠
                        </div>
                        <p style="margin-top: 15px; font-size: 0.9em; color: #666;">
                            <strong>Odkaz:</strong> <a href="https://isir.justice.cz" target="_blank" style="color: #2a5298;">Zobrazit detail v ISIR.cz</a>
                        </p>
                    </div>
                `;
            } else {
                statusEl.innerHTML = '‚úÖ ≈Ω√°dn√© z√°znamy nenalezeny v ISIR';
                statusEl.style.background = '#d4edda';
                statusEl.style.color = '#155724';
                
                resultsEl.innerHTML = `
                    <div style="color: #155724; text-align: center; padding: 30px;">
                        <div style="font-size: 3em; margin-bottom: 15px;">‚úì</div>
                        <p style="margin: 0; font-weight: 600;">Osoba <strong>${jmeno} ${prijmeni}</strong> (${datum}) nem√° z√°znam v insolvenƒçn√≠m rejst≈ô√≠ku.</p>
                    </div>
                `;
            }
        }

        // Zobrazen√≠ CEE v√Ωsledk≈Ø
        function zobrazitCeeVysledky(jmeno, prijmeni, datum) {
            // Simulace v√Ωsledk≈Ø (v re√°ln√© aplikaci by p≈ôi≈°ly z API)
            const nalezeno = Math.random() > 0.6; // 40% ≈°ance na n√°lez
            
            const statusEl = document.getElementById('ceeStatus');
            const resultsEl = document.getElementById('ceeResults');
            
            if (nalezeno) {
                const pocetExekuci = Math.floor(Math.random() * 3) + 1;
                statusEl.innerHTML = `‚ùå Nalezeno ${pocetExekuci} ${pocetExekuci === 1 ? 'z√°znam' : pocetExekuci < 5 ? 'z√°znamy' : 'z√°znam≈Ø'} v CEE`;
                statusEl.style.background = '#f8d7da';
                statusEl.style.color = '#721c24';
                
                let exekuceHtml = '';
                for (let i = 1; i <= pocetExekuci; i++) {
                    exekuceHtml += `
                        <div style="padding: 12px; background: #fff; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #e67e22;">
                            <strong>Exekuce ƒç. ${i}:</strong><br>
                            Spisov√° znaƒçka: ${Math.floor(Math.random() * 100)} EX ${Math.floor(Math.random() * 10000)}/2${Math.floor(Math.random() * 4)}<br>
                            Exekutor: JUDr. ${['Nov√°k', 'Dvo≈ô√°k', 'ƒåern√Ω', 'Proch√°zka'][Math.floor(Math.random() * 4)]}<br>
                            Stav: ${Math.random() > 0.5 ? 'Prob√≠haj√≠c√≠' : 'Ukonƒçen√°'}<br>
                            V√Ω≈°e dluhu: ${Math.floor(Math.random() * 500000 + 50000).toLocaleString('cs-CZ')} Kƒç
                        </div>
                    `;
                }
                
                resultsEl.innerHTML = `
                    <div style="color: #721c24;">
                        <p style="margin-bottom: 15px;"><strong>Osoba:</strong> ${jmeno} ${prijmeni}, nar. ${datum}</p>
                        ${exekuceHtml}
                        <p style="margin-top: 15px; font-size: 0.9em; color: #666;">
                            <strong>Odkaz:</strong> <a href="https://www.ceecr.cz" target="_blank" style="color: #2a5298;">Zobrazit detail na str√°nk√°ch Exekutorsk√© komory</a>
                        </p>
                    </div>
                `;
            } else {
                statusEl.innerHTML = '‚úÖ ≈Ω√°dn√© z√°znamy nenalezeny v CEE';
                statusEl.style.background = '#d4edda';
                statusEl.style.color = '#155724';
                
                resultsEl.innerHTML = `
                    <div style="color: #155724; text-align: center; padding: 30px;">
                        <div style="font-size: 3em; margin-bottom: 15px;">‚úì</div>
                        <p style="margin: 0; font-weight: 600;">Osoba <strong>${jmeno} ${prijmeni}</strong> (${datum}) nem√° z√°znam v centr√°ln√≠ evidenci exekuc√≠.</p>
                    </div>
                `;
            }
        }

        // Vymaz√°n√≠ formul√°≈ôe lustrace
        function vymazatFormular() {
            document.getElementById('lustraceJmeno').value = '';
            document.getElementById('lustracePrijmeni').value = '';
            document.getElementById('lustraceDatumNarozeni').value = '';
            
            document.getElementById('isirStatus').innerHTML = 'ƒåek√° na spu≈°tƒõn√≠ lustrace...';
            document.getElementById('isirStatus').style.background = '#ecf0f1';
            document.getElementById('isirStatus').style.color = '#7f8c8d';
            document.getElementById('isirResults').innerHTML = '<p style="color: #999; text-align: center; margin: 50px 0;">V√Ωsledky se zobraz√≠ po spu≈°tƒõn√≠ lustrace</p>';
            
            document.getElementById('ceeStatus').innerHTML = 'ƒåek√° na spu≈°tƒõn√≠ lustrace...';
            document.getElementById('ceeStatus').style.background = '#ecf0f1';
            document.getElementById('ceeStatus').style.color = '#7f8c8d';
            document.getElementById('ceeResults').innerHTML = '<p style="color: #999; text-align: center; margin: 50px 0;">V√Ωsledky se zobraz√≠ po spu≈°tƒõn√≠ lustrace</p>';
        }

        // ≈òazen√≠ tabulky
        let sortDirection = {};
        let currentSortColumn = null;

        function sortTable(columnIndex) {
            const direction = sortDirection[columnIndex] || 'asc';
            sortDirection[columnIndex] = direction === 'asc' ? 'desc' : 'asc';

            // Odstranit t≈ô√≠dy ze v≈°ech z√°hlav√≠
            document.querySelectorAll('th').forEach(th => {
                th.classList.remove('sort-asc', 'sort-desc');
            });

            // P≈ôidat t≈ô√≠du k aktu√°ln√≠mu z√°hlav√≠
            const currentTh = document.querySelector(`th[data-column="${columnIndex}"]`);
            if (currentTh) {
                currentTh.classList.add(direction === 'asc' ? 'sort-asc' : 'sort-desc');
            }

            currentSortColumn = columnIndex;

            const keys = ['type', 'property', 'source', 'price', 'area', null, 'date'];
            const key = keys[columnIndex];
            
            if (key) {
                filteredListings.sort((a, b) => {
                    const valA = a[key];
                    const valB = b[key];
                    if (typeof valA === 'string') {
                        return direction === 'asc' 
                            ? valA.localeCompare(valB) 
                            : valB.localeCompare(valA);
                    }
                    return direction === 'asc' ? valA - valB : valB - valA;
                });
                renderTable();
            }
        }

        // Populate cities dropdown
        function populateCities() {
            // U≈æ nen√≠ pot≈ôeba, mƒõsto je glob√°ln√≠ filtr v hlaviƒçce
        }

        // Z√°lo≈æky
        function initTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Deaktivovat v≈°echny z√°lo≈æky
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                    
                    // Aktivovat vybranou z√°lo≈æku
                    tab.classList.add('active');
                    const tabId = tab.getAttribute('data-tab');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        }

        // Event listeners
        document.getElementById('locationSelect').addEventListener('change', changeLocation);
        document.getElementById('filterType').addEventListener('change', applyFilters);
        document.getElementById('filterProperty').addEventListener('change', applyFilters);

        // Initialize
        initTabs();
        renderSources();
        updateLastUpdateTime();
        updateStats();
        renderTable();
        createCharts();
    </script>
</body>
</html>
